<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GrievanceForum</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="https://kit.fontawesome.com/08c3f952c9.js" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat&family=Quicksand:wght@600&display=swap');
        body{
            background-color:white;
            font-family: 'Montserrat', sans-serif;
            font-family: 'Quicksand', sans-serif;
        }
        @media (min-width:100px)  { }
        @media (min-width:600px)  { }
        @media (min-width:1281px) { }
    </style>
</head>
<body>
    <div class="container-fluid">
        <nav class="navbar bg-light">
            <div class="container-fluid">
                <a class="navbar-brand" href="../">
                    <i class="fa-regular fa-snowflake d-inline-block "></i>
                    GrievanceForum
                </a>
                <button class="btn btn-sm btn-outline-primary rounded-pill" style="width:140px">
                    <img src="<%=userInfo['picture']%>" class="rounded-circle" style="width:30%;"/>
                    <%=userInfo["name"]%>
                </button>
            </div>
        </nav><br>
        <nav class="navbar fixed-bottom bg-light">
            <div class="container-fluid">
                <div class="row w-100 text-center">
                    <div class="col">
                        <a href="../dashboard" type="button" class="btn btn-link"> <i class="fa-solid fa-house"></i></a>
                    </div>
                    <div class="col">
                        <a href="../manage" type="button" class="btn btn-link"> <i class="fa-solid fa-plus"></i></a>
                    </div>
                    <div class="col">
                        <a href="../notification" type="button" class="btn btn-link"> <i class="fa-solid fa-bell"></i></a>
                    </div>
                    <div class="col">
                        <a href="../profile" type="button" class="btn btn-link"> <i class="fa-solid fa-user"></i></a>
                    </div>
                </div>
            </div>
        </nav>
        <div class="post">
            <p class="fs-2"><%=postInfo.title%></p>
            <p class="text-muted"><%=postInfo.description%></p>
            <hr>
            <div class="text-muted" style="font-size:13px;">
                <div class="row">
                    <div class="col">Created On: <span style="color:black"><%=postInfo.datetime%></span></div>
                    <div class="col">Viewed: <span style="color:black"><%=postInfo.views%> times</span></div>
                </div>
            </div>
            <br>
            <div id="reportMarkdown">
                <%-report%>
            </div>
            <% if(postInfo.support == 1){ %>
            <div>
                <div class="row d-flex align-items-center justify-content-center">
                    <div class="col-4">
                        <button id="supportBtn" onclick="supportPost()" class="btn btn-large btn<%if(isSupporting == 0){%>-outline<%}%>-success"><i class="fa-solid fa-hand-sparkles"></i> <%if(isSupporting == 0){%>Support This Post<%}else{%>Currently Supporting<%}%></button>
                    </div>
                    <div class="col-7 text-align-start text-muted">
                        This Post Is Supported By <%=postInfo.likes%> Students
                    </div>
                </div>
            </div>
            <%}%>
            <hr>
            <div>
                <a href="" class="btn btn-sm btn-outline-secondary">
                    <div class="row">
                        <div class="col-1">
                            <img src="<%=postInfo.picture%>" class="rounded-circle" style="width:20px"/>
                        </div>
                        <div class="col-9 text-align-start"><%=postInfo.name%></div>
                    </div>
                </a>
                <div class="btn-group" role="group" aria-label="Basic example">
                    <button data-bs-toggle="modal" data-bs-target="#ShareModal" type="button" class="btn btn-sm btn-outline-secondary"><i class="fa-solid fa-arrow-up-right-from-square"></i> Share</button>
                    <button type="button" class="btn btn-sm btn-outline-secondary"><i class="fa-regular fa-bookmark"></i> Bookmark</button>
                </div>
            </div><br>
            <div class="comment">
                <p class="fs-3 text-muted">Comments</p>
                <div class="mb-3">
                    <label for="CommentArea" class="form-label">Post Your Comment</label>
                    <textarea class="form-control" id="CommentArea" rows="2"></textarea>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="ShareModal" tabindex="-1" aria-labelledby="ShareModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                <h1 class="modal-title fs-5" id="ShareModalLabel">Share The Post</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                <div class="mb-3">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" placeholder="Post Link" aria-label="Recipient's username" aria-describedby="button-addon2" readonly>
                        <button class="btn btn-light" type="button" id="button-addon2">Copy</button>
                    </div>
                    <hr>
                    <div class="card" style="border:0;overflow:hidden;">
                        <div class="d-flex" style="overflow-x:scroll;margin-left:10px;font-size:50px;">
                            <a href="https://api.whatsapp.com/send?text=CheckOut This Post In The GrievanceForum! {URL_HERE}" data-action="share/whatsapp/share"  target="_blank">
                                <i class="fa-brands fa-whatsapp text-muted"></i>
                            </a>
                            <a href="https://www.facebook.com/sharer/sharer.php?u=link_to_be_shared" style="margin-left:20px;" target="_blank">
                                <i class="fa-brands fa-facebook text-muted"></i>
                            </a>
                            <a href="https://twitter.com/intent/tweet?text=CheckOut This Post In The GrievanceForum&url=https://google.com" style="margin-left:20px;" target="_blank">
                                <i class="fa-brands fa-twitter text-muted"></i>
                            </a>
                            <a href="MAILTO:" style="margin-left:20px;" target="_blank">
                                <i class="fa-solid fa-envelope text-muted"></i>
                            </a>
                            <a href="http://www.reddit.com/submit?url=url_here&title=CheckOut This Post In The GrievanceForum" style="margin-left:20px;" target="_blank">
                                <i class="fa-brands fa-reddit text-muted"></i>
                            </a>
                            <a href="whatsapp://send?text=The text to share!" style="margin-left:20px;" target="_blank">
                                <i class="fa-brands fa-pinterest text-muted"></i>
                            </a>
                            <a href="whatsapp://send?text=The text to share!" style="margin-left:20px;" target="_blank">
                                <i class="fa-brands fa-linkedin text-muted"></i>
                            </a>
                            <a href="whatsapp://send?text=The text to share!" style="margin-left:20px;" target="_blank">
                                <i class="fa-brands fa-blogger text-muted"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </div>
    </div>
<script>
    function supportPost(){
        document.getElementById("supportBtn").setAttribute("disabled", "disabled");
        $("#supportBtn").html('<div class="spinner-border text-success" role="status"><span class="visually-hidden">Loading...</span></div>');
        
        $.post("/post",{
            supportPost:true,
            id:"<%=postInfo.id%>",
        },
        function(data, status){
            document.getElementById("supportBtn").removeAttribute("disabled");
            if(data == 0){
                $("#supportBtn").attr('class', 'btn btn-large btn-outline-success');
                $("#supportBtn").html('<i class="fa-solid fa-hand-sparkles"></i> Support The Post');
            }else{
                $("#supportBtn").attr('class', 'btn btn-large btn-success');
                $("#supportBtn").html('<i class="fa-solid fa-hand-sparkles"></i> Currently Supporting');
            }
        });
    }
</script>
</body>
</html>